version: "3.8"

services:
  aspire-dashboard:
    # https://azure.microsoft.com/pt-br/products/category/containers/
    # https://learn.microsoft.com/pt-br/dotnet/core/diagnostics/observability-otlp-example
    image: mcr.microsoft.com/dotnet/aspire-dashboard:13
    hostname: aspire-dashboard
    container_name: aspire-dashboard-${COMPOSE_PROJECT_NAME}
    restart: always
    user: "0:0"
    deploy:
      resources:
        limits:
          cpus: "4"
          memory: "4GB"
    networks:
      - nginxproxy
    healthcheck:
      test: ["CMD-SHELL", "wget --spider -q http://localhost:18888/ || exit 1"]
      interval: 15s
      timeout: 5s
      retries: 5
      start_period: 10s
    ports:
      - "18888:18888"
      - "18889:18889"
    environment:
      ASPIRE_DASHBOARD_UNSECURED_ALLOW_ANONYMOUS: "true"

networks:
  nginxproxy:
    name: nginxproxy
    driver: bridge